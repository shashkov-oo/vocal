# Vocal Pattern Trainer

Интерактивный тренажёр вокальных паттернов (пианино + автоаккомпанемент на сэмплах **Salamander**), работает прямо в браузере. Есть офлайн-режим через Service Worker, набор упражнений и визуализация нот/частоты.

> Репозиторий — статический фронтенд на JS/HTML/CSS; сейчас файлы живут в **корне** репо: `index.html`, `app.js`, `patterns.js`, `audio.js`, `graph.js`, `pitch.js`, `styles.css`, `sw.js`, директории `salamander/` и `examples/`. Стек по языкам: ~83% JS, ~9% HTML, ~8% CSS.

---

## Демо

Если включены GitHub Pages для ветки `main` и корня репозитория, проект будет доступен по адресу:

```
https://<твой-логин>.github.io/vocal/
```

(Либо через Settings → Pages, см. базовые шаги из прежнего README на странице репозитория. )

---

## Быстрый старт (локально)

> Важно: **нельзя** открывать `index.html` как `file://…` — браузер не отдаст mp3 и не поднимет Service Worker.

1) Склонируй репо и перейди в его папку.  
2) Запусти любой простой HTTP-сервер в **корне** проекта:

- **Windows (Python/PowerShell)**  
  ```powershell
  py -m http.server 8000
  ```
- **Linux/macOS**  
  ```bash
  python3 -m http.server 8000
  ```

3) Открой: `http://127.0.0.1:8000/`

---

## Сэмплы фортепиано (обязательно)

В каталоге `salamander/` должны лежать mp3-сэмплы (например, `C4.mp3`, `A3.mp3` и т. п.).  
Быстрая проверка: открой в браузере `http://127.0.0.1:8000/salamander/C4.mp3` — файл должен проигрываться/скачиваться.

> Ранее скрипты загрузки указывались для папки `docs/`, сейчас структура упрощена: **клади сэмплы прямо в `/salamander` в корне проекта**.

---

## Структура

```
/examples/       – примеры/черновики
/salamander/     – mp3-сэмплы пианино (обязательны)
index.html       – основная страница приложения
app.js           – инициализация UI, запуск упражнений
patterns.js      – каталог упражнений (названия, BPM, последовательности нот и пр.)
audio.js         – воспроизведение через Tone.Sampler
graph.js         – визуализация
pitch.js         – детекция и отображение высоты (при наличии микрофона)
styles.css       – стили
sw.js            – Service Worker и офлайн-кеш
.nojekyll        – сервисный файл для GitHub Pages
README.md        – этот файл
```

---

## Режим офлайн и обновления

Проект кэшируется через `sw.js`. При изменениях **меняй версию кеша** (например, `vocal-trainer-v3`), чтобы у пользователей подтянулся новый контент.

Шаги:
1) Обнови строковую константу версии в `sw.js`.  
2) Пересобирай/перезагружай страницу — браузер активирует новый SW и сбросит старый кеш.

---

## Упражнения: как устроены и как добавить свои

Все упражнения описаны в `patterns.js`. Базовая схема объекта (упрощённо):

```js
{
  id: "15",
  name: "Название упражнения",
  bpm: 150,
  type: "semitone" | "scale" | "arpeggio" | "...",
  data: [0, 4, 7, 12, 16, 19, 17, 14, 11, 7, 5, 2, 0], // относительные интервалы/ступени
  desc: "Короткое описание/подсказки по технике"
}
```

Добавь новый объект в массив `VPT.PATTERNS` и перезапусти приложение.  
Рекомендации:
- Держи `bpm` в разумных диапазонах (например, 80–160 для большинства паттернов).
- В `desc` фиксируй технику: дыхание, артикуляцию, ощущения резонанса и т. п.
- Если в упражнении нужны **микропаузи** (например, «после каждой третьей ноты 100 мс»), добавь соответствующее поле, например:
  ```js
  microPauseEvery: 3,      // каждые 3 ноты
  microPauseMs: 100        // длительность паузы
  ```
  и реализуй логику в месте триггера нот (обычно в `app.js`/`audio.js`). Если поля уже предусмотрены в коде — просто используй их; если нет — это минимальная доработка проигрывателя (вставка `await Tone.Transport.pause`/таймингового `setTimeout` между событиями).

> Подсказка: для устойчивого тайминга паузы лучше планировать события через `Tone.Transport.schedule`/`scheduleOnce`, а не через «голый» `setTimeout`.

---

## Полезные советы по звуку

- Чтобы микрофон не «подслушивал» громкость колонок/наушников при работе питч-трекера, снижай громкость воспроизведения, используй закрытые наушники или увеличивай порог чувствительности в коде `pitch.js`.  
- При первом запуске браузер запросит доступ к микрофону — разреши, если планируешь визуализацию высоты.

---

## Развёртывание на GitHub Pages

1) В Settings → Pages выбери ветку `main` и корневую папку.  
2) Сохрани настройки — через минуту сайт станет доступен по адресу вида `https://<логин>.github.io/vocal/`.  
3) При обновлениях помни про версию кеша в `sw.js`. 

---

## Вклад

PR и issue могут иметь место, но не обязательно будут обработаны.

---

## Лицензия

Пока явно не указана.
